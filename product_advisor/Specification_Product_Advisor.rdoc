Модуль Product Advisor
Фича New arrivals


1. В настройках модуля Product Advisor админ задаёт параметры:
1. максимальное количество товаров в списке new arrivals (опция How many new products to mark as new arivals);
2. нужно ли помечать такие товары специальной иконкой (через механизм promotion labels согласно скетчу) в виджетах списка товаров (опция Mark new arrivals in the catalog).
1. При редактировании/добавлении блока в Drupal админ может добавить блок с виджетом “New arrivals” (в stand-alone версии LC3 этот виджет жёстко встраивается модулем в шаблоны, см. в самом низу как). При этом, кроме типовых настроек для виджета списка товаров, админ задаёт, должен ли этот блок показывать на всех страницах все new arrivals, или же для страниц категорий там должны оставаться только товары из этих категорий и их подкатегорий (опция Show products only from the category being viewed by customer). 
2. При редактировании/добавлении товара админ задаёт дату начала продаж товара (такая фича уже есть в LC). Эта дата, наряду с настройкой из пункта 1, определяет, какие товары входят в список new arrivals (по убыванию даты начала продаж). Для таких товаров на странице их редактирования показывается фраза “This product will be shown in new arrivals”.
3. При отображении виджета “New arrivals” сортировка по убыванию даты является первичной, сортировка типом, выбранным пользователем, - вторичной.
4. Если для этого виджета pager отключен, а полный список new arrivals не помещается в блоке из-за его настроек, то появляется ссылка “All newest products”. Она открывает страницу со списком товаров new arrivals в центре, но уже с pager’ом и остальными элементами (сортировка, display mode).
5. В селектор выбора типа сортировки в виджетах списка товаров (любых, не только New Arrivals) должна быть добавлена опция “Newest first”, упорядочивающая товары в этом списке по дате начала их продаж (более новые - ближе к началу списка).
Фича Coming soon


1. В настройках модуля Product Advisor админ задаёт параметры:
1. видны ли Coming soon товары покупателям (опция Show ”coming soon” products in the catalog);
2. нужно ли помечать такие товары специальной иконкой (через механизм promotion labels согласно скетчу) в виджетах списка товаров (опция Mark “coming soon” products in the catalog);
3. нужно ли показывать даты начала продаж таких товаров покупателям на странице этих товаров и в Quick Look popup (опция Show arrival date for “coming soon” products).
1. При редактировании/добавлении блока в Drupal админ может добавить блок с виджетом “Coming soon” (в stand-alone версии LC3 этот виджет жёстко встраивается модулем в шаблоны, см. в самом низу как). При этом, кроме типовых настроек для виджета списка товаров, админ задаёт, должен ли этот блок показывать на всех страницах все coming soon товары, или же для страниц категорий там должны оставаться только товары из этих категорий и их подкатегорий (опция Show products only from the category being viewed by customer).
2. При редактировании/добавлении товара админ задаёт дату начала продаж товара (такая фича уже есть в LC). Эта дата, наряду с настройкой из пункта 1, определяет, какие товары входят в список coming soon (по возрастанию даты начала продаж начиная с текущего дня). Для таких товаров на странице их редактирования показывается фраза “This product will be shown in coming soon section”.
3. При отображении виджета “Coming soon” сортировка по возрастанию даты является первичной, сортировка типом, выбранным пользователем, - вторичной.
4. Если для этого виджета pager отключен, а полный список coming soon не помещается в блоке из-за его настроек, то появляется ссылка “All upcoming products”. Она открывает страницу со списком coming soon товаров в центре, но уже с pager’ом и остальными элементами (сортировка, display mode).
5. Coming soon товары нельзя положить в корзину и купить: на странице товара и в Quick Look кнопка добавления в корзину отсутствует, а в списках товаров drag’n’drop добавление в корзину отключено.
6. В storefront указывается, что это coming soon товар: на странице товара и в Quick Look - там, где указано in stock он, или out of stock; в списках товаров - там, где надпись “Drag products to the cart”, а также в зависимости от настройки модуля отмечается ярлыком “Coming soon” (promotion label). Также, в зависимости от опции из пункта 1 страница coming soon товара и Quick Look могут также отображать дату начала продаж товара.


Фича Recently viewed products


1. При редактировании/добавлении блока в Drupal админ может добавить блок с виджетом “Recently viewed products” (в stand-alone версии LC3 этот виджет жёстко встраивается модулем в шаблоны, см. в самом низу как). При этом админ задаёт настройки типовые для виджета списка товаров.
2. При отображении виджет “Recently viewed” показывает пользователю список товаров, страницу или QuickLook которых этот пользователь просмотрел в текущей сессии, при этом первыми в списке идут последние просмотренные товары. Такая сортировка является первичной, а сортировка типом, выбранным пользователем, - вторичной.
3. Если ни одного товара пользователь не просмотрел, то виджет не показывается




Фича Customers who bought this product also bought


1. При редактировании/добавлении блока в Drupal админ может добавить блок с виджетом “Customers who bought this product also bought” (в stand-alone версии LC3 этот виджет жёстко встраивается модулем в шаблоны, см. в самом низу как). При этом админ задаёт настройки типовые для виджета списка товаров.
2. При просморе страницы товара (на остальных страницах не показывается) этот виджет отображает пользователю список товаров, которые покупались в магазине пользователями, купившими просматриваемый товар. Список упорядочен по убыванию суммы количества покупок товара, совершённых этими пользователями. Такая сортировка является первичной, а сортировка типом, выбранным пользователем, - вторичной.


Фича Customers who viewed this product bought


1. При редактировании/добавлении блока в Drupal админ может добавить блок с виджетом “Customers who viewed this product bought” (в stand-alone версии LC3 этот виджет жёстко встраивается модулем в шаблоны, см. в самом низу как). При этом админ задаёт настройки типовые для виджета списка товаров.
2. При просморе страницы товара (на остальных страницах не показывается) этот виджет отображает пользователю список товаров, которые покупались другими пользователями в течение сессии после просмотра этого товара. Просмотром считается открытие страницы товара или его QuickLook. Список упорядочен по убыванию суммы количества покупок товара, совершённых этими пользователями. Такая сортировка является первичной, а сортировка типом, выбранным пользователем, - вторичной.


Положение блоков в скине для LC stand-alone


В боковой колонке, располагаясь под списком категорий:
1. New arrivals (display mode: list, 3 products)
2. Coming soon (display mode: list, 3 products)
3. Recently viewed (display mode: text links, 3 products)


В центральной части, для детальной страницы товара, под основным описанием:
1. Customers who bought this product also bought (display mode: grid, 3 products, without pagination and sorting controls)
2. Customers who viewed this product also bought (display mode: grid, 3 products, without pagination and sorting controls)




Требования к коду


Предоставленный код должен быть предоставлен с модульными тестами. Покрытию подлежат:
1. новые модели;
2. новые репозитории
3. новые методы существующих моделей ядра, других модулей и репозиториев
Покрытие тестами должно быть не менее 85%


Также все вновь добавленные элементы интерфейса покупателя должны быть покрыты функциональными тестами.